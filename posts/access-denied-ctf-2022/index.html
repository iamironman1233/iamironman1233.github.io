<!doctype html>
<html lang="vi">
  <head>
    <title>Writeups Access Denied CTF 2022 // Spid3r</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.101.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Thái Sơn" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.4a7ec8660f9a44b08c4da97c5f2e31b1192df1d4d0322e65c0dbbc6ecb1b863f.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Writeups Access Denied CTF 2022"/>
<meta name="twitter:description" content="Thu, 09 June 2022, 23:30 SST — Sat, 11 June 2022, 23:30 SST - On-line
Dưới đây là các bài mình làm được trong cuộc thi lần này
MISC [Shark1] Ở bài misc đầu tiên, chúng ta nhận được 1 file .pcapng tiến hành mở file bằng wireshark, ta thu được
Mình kiểm tra 1 vài TCP Protocol thì nhận được
Nên mình quyết định follow TCP (Follow &ndash;&gt; TCP Stream)"/>

    <meta property="og:title" content="Writeups Access Denied CTF 2022" />
<meta property="og:description" content="Thu, 09 June 2022, 23:30 SST — Sat, 11 June 2022, 23:30 SST - On-line
Dưới đây là các bài mình làm được trong cuộc thi lần này
MISC [Shark1] Ở bài misc đầu tiên, chúng ta nhận được 1 file .pcapng tiến hành mở file bằng wireshark, ta thu được
Mình kiểm tra 1 vài TCP Protocol thì nhận được
Nên mình quyết định follow TCP (Follow &ndash;&gt; TCP Stream)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/access-denied-ctf-2022/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-16T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-06-16T00:00:00+00:00" />



  </head>
  <body>
    <header class="app-header">
      <a href="/"><img class="app-header-avatar" src="/avatar.jpg" alt="Thái Sơn" /></a>
      <h1>Spid3r</h1>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">Home</a>
             - 
          
          <a class="app-header-menu-item" href="/about/">About</a>
             - 
          
          <a class="app-header-menu-item" href="/tags">Tags</a>
      </nav>
      <p>Càng khó càng vui</p>
      <div class="app-header-social">
        
          <a href="https://github.com/iamironman1233" target="_blank" rel="noreferrer noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="https://www.facebook.com/tson.03" target="_blank" rel="noreferrer noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-facebook">
  <title>facebook</title>
  <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Writeups Access Denied CTF 2022</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Jun 16, 2022
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          14 min read
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>
</svg>
              <a class="tag" href="/tags/accessdenied/">accessdenied</a>
              <a class="tag" href="/tags/ctf/">CTF</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <p><em>Thu, 09 June 2022, 23:30 SST — Sat, 11 June 2022, 23:30 SST</em> - <em><strong>On-line</strong></em></p>
<p><img src="https://i.imgur.com/KzwtF9B.png" alt=""></p>
<p>Dưới đây là các bài mình làm được trong cuộc thi lần này</p>
<hr>
<h1 id="misc">MISC</h1>
<h3 id="shark1">[Shark1]</h3>
<p>Ở bài misc đầu tiên, chúng ta nhận được 1 file .pcapng tiến hành mở file bằng wireshark, ta thu được</p>
<p><img src="https://i.imgur.com/QFViiy2.png" alt=""></p>
<p>Mình kiểm tra 1 vài TCP Protocol thì nhận được</p>
<p><img src="https://i.imgur.com/ID79OSC.png" alt=""></p>
<p>Nên mình quyết định follow TCP (Follow &ndash;&gt; TCP Stream)</p>
<p><img src="https://i.imgur.com/tCFc5Kb.png" alt="">
Vậy là chúng ta sẽ phải biến đổi cụm flag kia thông qua XOR với xor key = 80
Sử dụng trang <a href="https://cyberchef.org/">CyberChef</a> và điền các thông số vào</p>
<p><img src="https://i.imgur.com/DszMPKQ.png" alt=""></p>
<h5 id="---flag-accessdeniedw1r3sh4rk_b3st_f0r_p4ck3t_sn1ff1ng_9fc3841b1">&ndash;&gt; <em>flag: accessdenied{w1r3sh4rk_b3st_f0r_p4ck3t_sn1ff1ng_9fc3841b1}</em></h5>
<h3 id="bobs-favourite-number">[Bobs Favourite Number]</h3>
<p>Dữ kiện:</p>
<blockquote>
<p>Bobs favourite numbers
Bob likes two numbers 1856 (as his college was founded as the Civil Engineering College on 24 November 1856) and 2014 (as his college was renamed as Indian Institute of Engineering Science and Technology, Shibpur by the Govt. of India in March 2014).
A number N is Bob&rsquo;s favourite number if N is equal to the sum of a certain number of 1856 and sum of a certain number of 2014.
Task: Print whether a number is Bob&rsquo;s favourite number or not.
Input: 
First line contains a single integer number N.
Output:
Print “Yes” if Favourite if N is Bob’s favourite number, else print “No”.
Constraints: 1 &lt;= N &lt;= 10^9
Sample input:
5726
Sample output:
Yes
Sample explanation:
5726 can be represented as the sum of 1856 + 1856 + 2014.</p>
</blockquote>
<p>Ở bài này chúng ta chỉ nên để ý tới 2 số mà Bob thích đó là <code>1856</code> và <code>2014</code>.
Ở ví dụ 5726 nhập vào là đúng vì 5726 = 1856 + 1856 + 2014</p>
<p>Nên mình nghĩ nếu nhập 1 số có thể tách ra thành dạng a * 1856 + b * 2014 (a, b &gt;= 1) là sẽ được. Và đề có cho mình server: <code>nc 35.193.60.121 1337</code> 
Nên có lẽ các số được input vào sẽ ở trong này. Rất tiếc là server đã đóng nên mình không thể cho ảnh lên writeup được.</p>
<p>Để tạo 1 hàm tính xem số được nhập vào có phải dưới dạng a * 1856 + b * 2014 không, thì code rất đơn giản bằng python:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check</span>(n):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(int(n<span style="color:#f92672">/</span><span style="color:#ae81ff">1856</span>)): <span style="color:#75715e">#đây là cách nhanh để tạo 1 vòng lặp và thử </span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(n <span style="color:#f92672">-</span> (i<span style="color:#f92672">*</span><span style="color:#ae81ff">1856</span>))<span style="color:#f92672">%</span><span style="color:#ae81ff">2014</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> 
</span></span><span style="display:flex;"><span>               <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span></code></pre></div><p>và <code>print(check(5726))</code> thì ta được kết quả là True.
Thử kết nối tới server bằng netcat ta được kết quả trả về:</p>
<pre tabindex="0"><code>168936
Answer:
</code></pre><p>Nhập Yes</p>
<pre tabindex="0"><code>Good one
</code></pre><pre tabindex="0"><code>2512426
Answer:
</code></pre><p>Nhập No</p>
<pre tabindex="0"><code>Wrong Answer
</code></pre><p>Vậy là khi chúng ta truy cập vào server, nó sẽ đưa chúng ta 1 số và thử, 
Tiếp theo chúng ta sẽ sử dụng đến <a href="https://www.geeksforgeeks.org/telnet-python-network-programming/">Telnet</a> để truy cập vào server của đề và thử các input đó</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> telnetlib
</span></span><span style="display:flex;"><span>tn <span style="color:#f92672">=</span> telnetlib<span style="color:#f92672">.</span>Telnet(<span style="color:#e6db74">&#34;35.193.60.121&#34;</span>, <span style="color:#ae81ff">1337</span>)
</span></span></code></pre></div><hr>
<p>lệnh thử:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">while</span>(<span style="color:#66d9ef">True</span>):
</span></span><span style="display:flex;"><span>    a <span style="color:#f92672">=</span> tn<span style="color:#f92672">.</span>read_until(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Answer:&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Good&#34;</span> <span style="color:#f92672">in</span> a: 
</span></span><span style="display:flex;"><span>        num <span style="color:#f92672">=</span> int(a<span style="color:#f92672">.</span>split()[<span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        num <span style="color:#f92672">=</span> int(a<span style="color:#f92672">.</span>split()[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> check(num):
</span></span><span style="display:flex;"><span>        tn<span style="color:#f92672">.</span>write(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Yes</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        tn<span style="color:#f92672">.</span>write(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;No</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><p>Sau khi chạy xong các test sẽ trả về flag:</p>
<h5 id="---flag-accessdeniedb0bs_f4v0r1t3_4r3_m1n3_f4v0urit3_t00_61c884c8">&ndash;&gt; <em><strong>flag: accessdenied{b0bs_f4v0r1t3_4r3_m1n3_f4v0urit3_t00_61c884c8}</strong></em></h5>
<h2 id="crypto">Crypto</h2>
<h3 id="rsa---1">[RSA - 1]</h3>
<p>Ở bài đầu tiên của crypto chúng ta lại gặp 1 dạng quen thuộc đó là giải mã RSA, vì có tới 3 bài loại này cho nên RSA - 1 là dễ hơn hẳn 
Dữ liệu đề:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">10428615258416108003372202871855627713663325599674460924186517713082197448534315449595394752587304354394402047262801959990727856908043138185588365886987557</span>
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> <span style="color:#ae81ff">8849030739304056868757301096931487921973840186794195322071503751716059434197468028088264340322992996182734000877348221433845302801843370163430108727308579</span>
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
</span></span><span style="display:flex;"><span>cipher_text <span style="color:#f92672">=</span> <span style="color:#ae81ff">84826403344972753121997388456739256614537789930909176473018827332005543366933391914385410712984001888365906754988120732970328825657318675360778107518188000885732104031648548997976916964730682864696944786364581243443475767387970255510475855029059715864139791778210784283726274424510221073880200865856769716576</span>
</span></span></code></pre></div><p>Vậy là đề đã cho cả p, q, e và c. Ở đây chúng ta tính ra n bằng cách lấy p * q
Tham khảo <a href="https://www.youtube.com/watch?v=WI5Ie36mUX0">video của mình</a> về loại bài này ta được code</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">8849030739304056868757301096931487921973840186794195322071503751716059434197468028088264340322992996182734000877348221433845302801843370163430108727308579</span>
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> <span style="color:#ae81ff">10428615258416108003372202871855627713663325599674460924186517713082197448534315449595394752587304354394402047262801959990727856908043138185588365886987557</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> p<span style="color:#f92672">*</span>q
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> <span style="color:#ae81ff">84826403344972753121997388456739256614537789930909176473018827332005543366933391914385410712984001888365906754988120732970328825657318675360778107518188000885732104031648548997976916964730682864696944786364581243443475767387970255510475855029059715864139791778210784283726274424510221073880200865856769716576</span>
</span></span><span style="display:flex;"><span>d1 <span style="color:#f92672">=</span> (p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>(q<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>d <span style="color:#f92672">=</span> pow(e, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, d1)
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> pow(c, d, n)
</span></span><span style="display:flex;"><span>print(flag<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">47</span>, <span style="color:#e6db74">&#39;big&#39;</span>))
</span></span></code></pre></div><h5 id="---flag-accessdeniedrsa_1s_4m4z1ng_r1ght_2a5286af">&ndash;&gt; <em><strong>flag: accessdenied{RSA_1S_4M4Z1nG_R1GhT????_2a5286af}</strong></em></h5>
<h3 id="rsa-3">[RSA-3]</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>N1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">18266349196400324728796632198426724065863341515460128017379722167088811564142208540762217975696666190887534687486334974478770458134458646785682182438231047535912495200486295399237083743354006572775979196273345894016812147421648391560534928953791045301656072851030393661346227010573392017192092871743599780733618974144278058844414678104713310777338685821340236864598500469843212331330335171804328016140678014295178395686821469446312308097781506852568269309368807576215036130913554259546509277614896420588483929704110258122427731934119749960465772609969329231395097168664992720797902433454838999670183197496533599372453</span>
</span></span><span style="display:flex;"><span>e1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
</span></span><span style="display:flex;"><span>ct1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">6873813036805706192019236826822502457972771100457517090756917047060847774848540323350759250580238758998913544271128101335276213320240302206398066922772200444602226203653559017733029810367927075606003863202964202725297461799495530697341270915140044964898303984854574497628349362668695378519684693264593494716972185326436905495762497116849607924837994943127697112124217181161062684698865533001086211217060178202980704668203486578672364578669469712587269077695001297138207491663356223994825422557742042083843727850238507161657755737436196961552942941154267260840237025593539923533367161391402240798650010287812581011106</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>N2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">24659767524526013018768938973883991511377669248630968999008468264428208747461052247749924232027616129566843290411914770222062361142014390330463814302544910044772535448949923181736285951382305617780092296934319600643083108399436503551987425616568398265868184384255524744326852580109993750455923648308457300741311644056806840080239266629430170801800674692923486070263947659308964150022391540089059138911526148899685247042835949241530880572488161927637699425020944697998483747469309576045917038431425710502056969197916002745593176785614139365197372746789456581367558816039809574657471032143676431357391125588624599050493</span>
</span></span><span style="display:flex;"><span>e2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
</span></span><span style="display:flex;"><span>ct2 <span style="color:#f92672">=</span>  <span style="color:#ae81ff">11715772208083492702167997175167454009301340692399196360593824415816062365292031273728996255749695189978948242292097965040268601546052250584302206331424224398934005270192769085862845465718216946900897219973683677713043297722976307588263004621450861659350169718646844558379707749844428304916965303036455448719228506667752535085465025614399994834368259311922477097878143154258042140694172977284700008301528490157090476538427961683829505682126281348126157784828204887638985638647829395157101409725453166939388563809584382420835218557337222313577592617066209235421605768519128885685600282422644017925260843832358253267634</span>
</span></span></code></pre></div><blockquote>
<p>code python:</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>N1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">18266349196400324728796632198426724065863341515460128017379722167088811564142208540762217975696666190887534687486334974478770458134458646785682182438231047535912495200486295399237083743354006572775979196273345894016812147421648391560534928953791045301656072851030393661346227010573392017192092871743599780733618974144278058844414678104713310777338685821340236864598500469843212331330335171804328016140678014295178395686821469446312308097781506852568269309368807576215036130913554259546509277614896420588483929704110258122427731934119749960465772609969329231395097168664992720797902433454838999670183197496533599372453</span>
</span></span><span style="display:flex;"><span>e1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
</span></span><span style="display:flex;"><span>ct1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">6873813036805706192019236826822502457972771100457517090756917047060847774848540323350759250580238758998913544271128101335276213320240302206398066922772200444602226203653559017733029810367927075606003863202964202725297461799495530697341270915140044964898303984854574497628349362668695378519684693264593494716972185326436905495762497116849607924837994943127697112124217181161062684698865533001086211217060178202980704668203486578672364578669469712587269077695001297138207491663356223994825422557742042083843727850238507161657755737436196961552942941154267260840237025593539923533367161391402240798650010287812581011106</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>N2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">24659767524526013018768938973883991511377669248630968999008468264428208747461052247749924232027616129566843290411914770222062361142014390330463814302544910044772535448949923181736285951382305617780092296934319600643083108399436503551987425616568398265868184384255524744326852580109993750455923648308457300741311644056806840080239266629430170801800674692923486070263947659308964150022391540089059138911526148899685247042835949241530880572488161927637699425020944697998483747469309576045917038431425710502056969197916002745593176785614139365197372746789456581367558816039809574657471032143676431357391125588624599050493</span>
</span></span><span style="display:flex;"><span>e2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
</span></span><span style="display:flex;"><span>ct2 <span style="color:#f92672">=</span>  <span style="color:#ae81ff">11715772208083492702167997175167454009301340692399196360593824415816062365292031273728996255749695189978948242292097965040268601546052250584302206331424224398934005270192769085862845465718216946900897219973683677713043297722976307588263004621450861659350169718646844558379707749844428304916965303036455448719228506667752535085465025614399994834368259311922477097878143154258042140694172977284700008301528490157090476538427961683829505682126281348126157784828204887638985638647829395157101409725453166939388563809584382420835218557337222313577592617066209235421605768519128885685600282422644017925260843832358253267634</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> inverse, long_to_bytes, bytes_to_long
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> gmpy2 <span style="color:#f92672">import</span> mul,gcd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">ProductTree</span>(s):
</span></span><span style="display:flex;"><span>    l <span style="color:#f92672">=</span> len(s)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> l <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> l <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            s <span style="color:#f92672">+=</span> [<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>            l <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        s <span style="color:#f92672">=</span> list(map(mul, s[<span style="color:#ae81ff">0</span> : l <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span>], s[l <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span> :]))
</span></span><span style="display:flex;"><span>        l <span style="color:#f92672">=</span> len(s)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> s[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Find_factor</span>(pubs):
</span></span><span style="display:flex;"><span>	priv_keys <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>	M <span style="color:#f92672">=</span> ProductTree(pubs)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(pubs) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>		pub <span style="color:#f92672">=</span> pubs[i]
</span></span><span style="display:flex;"><span>		R <span style="color:#f92672">=</span> M <span style="color:#f92672">//</span> pub
</span></span><span style="display:flex;"><span>		g <span style="color:#f92672">=</span> gcd(pub, R)
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> pub <span style="color:#f92672">&gt;</span> g <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>				p <span style="color:#f92672">=</span> g
</span></span><span style="display:flex;"><span>				q <span style="color:#f92672">=</span> pub <span style="color:#f92672">//</span> g
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">return</span> p,q
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> ex:
</span></span><span style="display:flex;"><span>				print(ex)
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p1,q1 <span style="color:#f92672">=</span> Find_factor([N1,N2])
</span></span><span style="display:flex;"><span>p2,q2 <span style="color:#f92672">=</span> Find_factor([N2,N1])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n1 <span style="color:#f92672">=</span> p1<span style="color:#f92672">*</span>q1
</span></span><span style="display:flex;"><span>n2 <span style="color:#f92672">=</span> p2<span style="color:#f92672">*</span>q2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>phi1 <span style="color:#f92672">=</span> (p1<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (q1<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>phi2 <span style="color:#f92672">=</span> (p2<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (q2<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d1 <span style="color:#f92672">=</span> inverse(e1, phi1)
</span></span><span style="display:flex;"><span>d2 <span style="color:#f92672">=</span> inverse(e2, phi2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>m1 <span style="color:#f92672">=</span> pow(ct1, d1, n1)
</span></span><span style="display:flex;"><span>m2 <span style="color:#f92672">=</span> pow(ct2, d2, n2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(long_to_bytes(m1)<span style="color:#f92672">+</span>long_to_bytes(m2))
</span></span></code></pre></div><h5 id="---flag-accessdeniedr3us31ng_5tuff_1s_n0t_f0r_crypt0gr4phy_69c36434">&ndash;&gt; <em><strong>flag: accessdenied{r3us31ng_5tuff_1s_n0t_f0r_crypt0gr4phy_69c36434}</strong></em></h5>
<hr>
<h2 id="rev">REV</h2>
<h3 id="babyc">[babyc]</h3>
<p>Ở bài này chúng ta sẽ đọc kĩ code và phân tích để đảo ngược lại flag đang được cho nhiễu ban đầu.</p>
<h4 id="đọc-file-rev1c">Đọc file rev1.c</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define MAXSIZE 100
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">char</span> flag[] <span style="color:#f92672">=</span> {<span style="color:#f92672">-</span><span style="color:#ae81ff">111</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">47</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">47</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">39</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">49</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">97</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">127</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">49</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">49</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">121</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">69</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">111</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">113</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">97</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">101</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">91</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">69</span>, <span style="color:#ae81ff">11</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">87</span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span> <span style="color:#a6e22e">reverse</span>(<span style="color:#66d9ef">char</span> ch) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">8</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">*=</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>((ch <span style="color:#f92672">&amp;</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i))) {
</span></span><span style="display:flex;"><span>            x<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">char</span>)x;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">encode</span>(<span style="color:#66d9ef">char</span> str[]) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> xor <span style="color:#f92672">=</span> <span style="color:#ae81ff">23</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; str[i] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;\0&#39;</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        str[i] <span style="color:#f92672">=</span> reverse(str[i]);
</span></span><span style="display:flex;"><span>        str[i] <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)(xor <span style="color:#f92672">^</span> str[i]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> str[MAXSIZE];
</span></span><span style="display:flex;"><span>    scanf(<span style="color:#e6db74">&#34;%100s&#34;</span>, str);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    getchar();
</span></span><span style="display:flex;"><span>    encode(str);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(strcmp(flag, str) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>){
</span></span><span style="display:flex;"><span>        printf(<span style="color:#e6db74">&#34;Access Granted :(&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>{
</span></span><span style="display:flex;"><span>        printf(<span style="color:#e6db74">&#34;Access Denied :)&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>có thể thấy từ void <code>reverse</code> ta có 1 phần tử của flag (lấy trường hợp cụ thể là <strong>flag[0]</strong>) khi chạy qua <code>reverse</code> sẽ tiếp tục chạy thêm vòng lặp gồm 8 loop (0 &ndash;&gt;7) sẽ biến đổi:</p>
<p>Ví dụ <strong>a</strong> (text) &ndash;&gt; <strong>01100001</strong> (binary) và qua 8 lần so sánh với <strong>00000001</strong> (và các cách dịch chuyển sang trái 1 bit của nó) thì ta được biến x lúc này thành:
( ( ( ( 0 * 2 + 1 )* 2 * 2 * 2 * 2) * 2 + 1) * 2 + 1) * 2  = <strong>134</strong></p>
<p>và ngay cuối hàm ta thấy ép kiểu x sang <code>char</code> nên lúc này x mặc định để ta tính là: <strong>10001100</strong>.</p>
<p>Tiếp theo từ việc <code>encode</code> flag (ta coi là đang encode 1 phần tử <strong>flag[0]</strong>) ta thấy rằng trong hàm encode sẽ có reverse (bước trên đã làm) và biến đổi <strong>flag[0]</strong> lúc này bằng:
<strong><code>xr ^ flag[0]</code></strong> (đã được ép kiểu sang char và xr ở đây bằng <strong>23</strong>(dec) &ndash;&gt; <strong>00010111</strong>(bin))</p>
<p>Chúng ta sẽ tiến hành in thử flag ra thì được: 
<code>æ╤╤▒┘┘1▒aü▒1╔   φ;a1φY█y█Y╗█φæY█φq╣aφ¢11</code>
<code>[╗</code>
<code>▒⌐</code></p>
<p>Mình nghĩ đây là flag đã được biến đổi giống như chúng ta encode và reverse <code>str</code>.</p>
<p>Thật vậy, mình với kinh nghiệm làm bài rsa-1 thì đã biết form của flag là <code>accessdenied{}</code> nên mình thử nhập str là <code>a</code> thêm <code>printf(&quot;%s&quot;, flag)</code> thì đều thu được đầu ra là 2 kí tự giống hệt nhau <code>æ æ</code>.</p>
<p>mình thử ẩn dòng <code>str[i] = (char)(xr ^ str[i]);</code> dưới comment và thêm thử hàm decode:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> decode(<span style="color:#66d9ef">char</span> flag[]) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i, xor = <span style="color:#ae81ff">23</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>( i = <span style="color:#ae81ff">0</span>; flag[i] != <span style="color:#e6db74">&#39;\0&#39;</span>; i++) {
</span></span><span style="display:flex;"><span>        str[i] = (<span style="color:#66d9ef">char</span>)(xor ^ flag[i]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>đến đây <strong>flag</strong> và <strong>str</strong> vẫn giống nhau. nên mình nhận ra có điều gì đó chúng ta có thể rút gọn được</p>
<p>và mình để ý 1 chút ở số <strong>134</strong> ở bên trên thì đổi ra thành <strong>01100001</strong> và đúng bằng <strong>decode(flag[0])</strong> được đảo ngược lại</p>
<p>:::success
:bulb: vậy nên mình nghĩ chỉ cần sử dụng hàm <strong>decode(flag)</strong> và đảo ngược lại nó là xong
:::</p>
<h4 id="viết-lại-code-viết-lại-bằng-c">Viết lại code (viết lại bằng C)</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> flag[] <span style="color:#f92672">=</span> {<span style="color:#f92672">-</span><span style="color:#ae81ff">111</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">47</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">47</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">39</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">49</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">97</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">127</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">49</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">49</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">121</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">69</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">111</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">113</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">97</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">101</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">91</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">69</span>, <span style="color:#ae81ff">11</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">87</span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> xr <span style="color:#f92672">=</span> <span style="color:#ae81ff">23</span>, i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; flag[i] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;\0&#39;</span>; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        flag[i] <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)(xr <span style="color:#f92672">^</span> flag[i]);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (flag[i] <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>            flag[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">256</span> <span style="color:#f92672">+</span> flag[i];
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//ở đây sẽ không thêm trường hợp của số dương vì mình thử thì thấy thế =))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        printf(<span style="color:#e6db74">&#34;%d, &#34;</span>, flag[i]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Kết quả in ra chuỗi các số nhị phân (ở đây có thể hiểu chính là flag dưới dạng nhị phân đã bị đảo ngược)</p>
<p>Kết quả sau khi viết lại chương trình ta thu được dãy các số nguyên được hiểu là sau khi đảo ngược của <strong>encode(flag)</strong></p>
<h4 id="chuyển-dãy-số-về-số-nhị-phân">Chuyển dãy số về số nhị phân</h4>
<blockquote>
<p>mình sử dụng C++ cho đơn giản, còn nếu bạn nào muốn chạy từng số 1 có thể dùng tool</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> flag[] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">134</span>, <span style="color:#ae81ff">198</span>, <span style="color:#ae81ff">198</span>, <span style="color:#ae81ff">166</span>, <span style="color:#ae81ff">206</span>, <span style="color:#ae81ff">206</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">166</span>, <span style="color:#ae81ff">118</span>, <span style="color:#ae81ff">150</span>, <span style="color:#ae81ff">166</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">222</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">250</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">118</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">250</span>, <span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">204</span>, <span style="color:#ae81ff">110</span>, <span style="color:#ae81ff">204</span>, <span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">172</span>, <span style="color:#ae81ff">204</span>, <span style="color:#ae81ff">250</span>, <span style="color:#ae81ff">134</span>, <span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">204</span>, <span style="color:#ae81ff">250</span>, <span style="color:#ae81ff">102</span>, <span style="color:#ae81ff">174</span>, <span style="color:#ae81ff">118</span>, <span style="color:#ae81ff">250</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">76</span>, <span style="color:#ae81ff">172</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">166</span>, <span style="color:#ae81ff">190</span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">DecimalToBinary</span>(<span style="color:#66d9ef">int</span> n) {
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">int</span> binaryNumber[<span style="color:#ae81ff">100</span>], num<span style="color:#f92672">=</span>n;
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">while</span> (n <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      binaryNumber[i] <span style="color:#f92672">=</span> n <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>      n <span style="color:#f92672">=</span> n <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>      i<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">int</span> j;
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">for</span> (j <span style="color:#f92672">=</span> i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>; j<span style="color:#f92672">--</span>)
</span></span><span style="display:flex;"><span>   cout<span style="color:#f92672">&lt;&lt;</span>binaryNumber[j];
</span></span><span style="display:flex;"><span>   cout<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34; &#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">46</span>; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        DecimalToBinary(flag[i]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Sau khi chuyển dãy trên về số nhị phân ta thu được dãy nhị phân như sau:</p>
<pre tabindex="0"><code>10000110 11000110 11000110 10100110 11001110 11001110 100110 10100110 1110110 10010110 10100110 100110 11011110 11110 1100 1001110 11111010 101100 1110110 100110 11111010 1001110 11001100 1101110 11001100 1001110 10101100 11001100 11111010 10000110 1001110 11001100 11111010 1100110 10101110 1110110 11111010 10001100 100110 100110 11100 1001100 10101100 11100 10100110 10111110
</code></pre><p>ta để ý thêm cho các số nhị phân sao cho đủ 8 bit để khi đổi chiều lại không bị lỗi</p>
<h4 id="code-đảo-ngược-các-chuỗi-binary-để-tìm-ra-flag">Code đảo ngược các chuỗi binary để tìm ra flag</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">str_reverse</span>(<span style="color:#66d9ef">char</span> str[]) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> lo <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> length;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (length <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; str[length] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;\0&#39;</span> ; length<span style="color:#f92672">++</span>) {} 
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> ( lo <span style="color:#f92672">&lt;</span> length ) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">--</span>length;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> tmp <span style="color:#f92672">=</span> str[lo];
</span></span><span style="display:flex;"><span>    str[lo] <span style="color:#f92672">=</span> str[length];
</span></span><span style="display:flex;"><span>    str[length] <span style="color:#f92672">=</span> tmp;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">++</span>lo;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> str[<span style="color:#ae81ff">100</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (i  <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>    cin <span style="color:#f92672">&gt;&gt;</span>  str;
</span></span><span style="display:flex;"><span>    str_reverse(str);
</span></span><span style="display:flex;"><span>    cout <span style="color:#f92672">&lt;&lt;</span> str <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34; &#34;</span>;
</span></span><span style="display:flex;"><span>    i<span style="color:#f92672">--</span>;}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Sau khi đã đảo ngược xong, ta thu được dãy</p>
<pre tabindex="0"><code>01100001 01100011 01100011 01100101 01110011 01110011 01100100 01100101 01101110 01101001 01100101 01100100 01111011 01111000 00110000 01110010 01011111 00110100 01101110 01100100 01011111 01110010 00110011 01110110 00110011 01110010 00110101 00110011 01011111 01100001 01110010 00110011 01011111 01100110 01110101 01101110 01011111 00110001 01100100 01100100 00111000 00110010 00110101 00111000 01100101 01111101
</code></pre><p>Sử dụng trang <a href="https://www.rapidtables.com/convert/number/binary-to-ascii.html">web này</a> để xử lý nốt phần còn lại và thu được flag.</p>
<hr>
<h5 id="----flag-accessdeniedx0r_4nd_r3v3r53_ar3_fun_1dd8258e">&mdash;&gt; <em><strong>flag: accessdenied{x0r_4nd_r3v3r53_ar3_fun_1dd8258e}</strong></em></h5>
<p>Trên đó là cách giải chay như lúc mình nghĩ ra, còn khi vào làm thực sự thì chúng ta chỉ cần sử dụng việc giải ngược lại của flag là done.
Code để đảo ngược:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span><span style="color:#ae81ff">46</span>;i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">char</span> c <span style="color:#f92672">=</span> flag[i];
</span></span><span style="display:flex;"><span>        printf(<span style="color:#e6db74">&#34;%c&#34;</span>, reverse(<span style="color:#ae81ff">23</span> <span style="color:#f92672">^</span> flag[i]));
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>full code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define MAXSIZE 100
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">char</span> flag[] <span style="color:#f92672">=</span> {<span style="color:#f92672">-</span><span style="color:#ae81ff">111</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">47</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">47</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">39</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">49</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">97</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">127</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">49</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">49</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">121</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">69</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">111</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">113</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">97</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">101</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">91</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">69</span>, <span style="color:#ae81ff">11</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">87</span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span> <span style="color:#a6e22e">reverse</span>(<span style="color:#66d9ef">char</span> ch)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">8</span>; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">*=</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ((ch <span style="color:#f92672">&amp;</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i)))
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            x<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">char</span>)x;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">encode</span>(<span style="color:#66d9ef">char</span> str[])
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> xr <span style="color:#f92672">=</span> <span style="color:#ae81ff">23</span>, i;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; str[i] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;\0&#39;</span>; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        str[i] <span style="color:#f92672">=</span> reverse(str[i]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> str[MAXSIZE];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">46</span>; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">char</span> c <span style="color:#f92672">=</span> flag[i];
</span></span><span style="display:flex;"><span>        printf(<span style="color:#e6db74">&#34;%c&#34;</span>, reverse(<span style="color:#ae81ff">23</span> <span style="color:#f92672">^</span> flag[i]));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    getchar();
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;%s&#34;</span>, flag);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="update-sau-khi-kết-thúc-giải">Update (Sau khi kết thúc giải)</h4>
<p>Sau khi tham khảo về sự khả thi của python thì mình thấy viết lại bằng python nhẹ hơn rất nhiều, dưới đây là code python của bạn <strong>zebruh</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> [<span style="color:#f92672">-</span><span style="color:#ae81ff">111</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">47</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">47</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">39</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">49</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">97</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">127</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">49</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">49</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">121</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">69</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">111</span>, <span style="color:#ae81ff">89</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">37</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">113</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">97</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">101</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">91</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">69</span>, <span style="color:#ae81ff">11</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">79</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">87</span>]
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">46</span>)]
</span></span><span style="display:flex;"><span>b<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">46</span>)]
</span></span><span style="display:flex;"><span>c<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">46</span>)]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">one</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,len(flag),<span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        flag[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">23</span> <span style="color:#f92672">^</span> flag[i]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (flag[i] <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>):
</span></span><span style="display:flex;"><span>            flag[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">256</span> <span style="color:#f92672">+</span> flag[i]
</span></span><span style="display:flex;"><span>        a[i] <span style="color:#f92672">=</span> flag[i]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>one()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">to_bin</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range (<span style="color:#ae81ff">0</span>,len(a),<span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        b[i]<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{0:08b}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(a[i])
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>to_bin()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range (<span style="color:#ae81ff">0</span>,len(b),<span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>    c[i]<span style="color:#f92672">=</span>b[i][::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    print(c[i])
</span></span></code></pre></div><p>Cả 2 đều có điểm chung là cùng một phương pháp, cùng tạo ra chuỗi nhị phân cuối cùng:</p>
<pre tabindex="0"><code>01100001 01100011 01100011 01100101 01110011 01110011 01100100 01100101 01101110 01101001 01100101 01100100 01111011 01111000 00110000 01110010 01011111 00110100 01101110 01100100 01011111 01110010 00110011 01110110 00110011 01110010 00110101 00110011 01011111 01100001 01110010 00110011   01011111 01100110 01110101 01101110 01011111 00110001 01100100 01100100 00111000 00110010 00110101 00111000 01100101 01111101
</code></pre><p>và cùng phải nhờ sự trợ giúp của tool để chuyển đổi nốt sang text 1 cách nhanh chóng, nhưng về mặt tốc độ thì python là hơn hẳn.</p>
<h3 id="bits-are-fun">[Bits are Fun]</h3>
<p>Làm tương tự như bài rev1 ta được code như sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define MAXSIZE 100
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span> flag[] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">105</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">103</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">113</span>, <span style="color:#ae81ff">102</span>, <span style="color:#ae81ff">103</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">111</span>, <span style="color:#ae81ff">108</span>, <span style="color:#ae81ff">113</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">108</span>, <span style="color:#ae81ff">118</span>, <span style="color:#ae81ff">119</span>, <span style="color:#ae81ff">112</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">118</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">116</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">117</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">127</span>, <span style="color:#ae81ff">112</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">103</span>, <span style="color:#ae81ff">96</span>, <span style="color:#ae81ff">118</span>, <span style="color:#ae81ff">125</span>, <span style="color:#ae81ff">112</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">118</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">116</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">119</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">119</span>, <span style="color:#ae81ff">98</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">120</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">119</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">102</span>, <span style="color:#ae81ff">103</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">117</span>, <span style="color:#ae81ff">97</span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">left_rotate_and_right_rotate</span>(<span style="color:#66d9ef">char</span> str[]) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i, len <span style="color:#f92672">=</span> strlen(str);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">8</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>((i <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> j, store <span style="color:#f92672">=</span> ((((<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i) <span style="color:#f92672">&amp;</span> str[len <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>]) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">?</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span>(j <span style="color:#f92672">=</span> len <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>; j <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>; j<span style="color:#f92672">--</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> bit <span style="color:#f92672">=</span> ((((<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i) <span style="color:#f92672">&amp;</span> str[j]) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">?</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>                str[j <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">&amp;=</span> (<span style="color:#f92672">~</span>(<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i));
</span></span><span style="display:flex;"><span>                str[j <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">|=</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i) <span style="color:#f92672">*</span> bit;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            str[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">&amp;=</span> (<span style="color:#f92672">~</span>(<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i));
</span></span><span style="display:flex;"><span>            str[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">|=</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i) <span style="color:#f92672">*</span> store;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> j, store <span style="color:#f92672">=</span> ((((<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i) <span style="color:#f92672">&amp;</span> str[<span style="color:#ae81ff">0</span>]) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">?</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span>(j <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;</span> len; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> bit <span style="color:#f92672">=</span> ((((<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i) <span style="color:#f92672">&amp;</span> str[j]) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">?</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>                str[j <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">&amp;=</span> (<span style="color:#f92672">~</span>(<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i));
</span></span><span style="display:flex;"><span>                str[j <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">|=</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i) <span style="color:#f92672">*</span> bit;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            str[len <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">&amp;=</span> (<span style="color:#f92672">~</span>(<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i));
</span></span><span style="display:flex;"><span>            str[len <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">|=</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i) <span style="color:#f92672">*</span> store;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>(str);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>tmp;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1000</span>; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        tmp <span style="color:#f92672">=</span> left_rotate_and_right_rotate(flag);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(strncmp(tmp,<span style="color:#e6db74">&#34;accessdenied&#34;</span>,<span style="color:#ae81ff">12</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            printf(<span style="color:#e6db74">&#34;%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,tmp);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h5 id="---flag-accessdeniedl3ft_r0t4t3_4nd_r1ght_r0t4t35_4r3_h4rd_5a43cfe4">&ndash;&gt; <em><strong>flag: accessdenied{l3ft_r0t4t3_4nd_r1ght_r0t4t35_4r3_h4rd_5a43cfe4}</strong></em></h5>
<h3 id="enormous">[enormous]</h3>
<p>Ở bài này thì đơn giản ở chỗ (hoặc là mình bị lừa vì mình không test flag được) chúng ta sử dụng <strong>IDA</strong> (bản nào cũng được nhưng phải là bản thích hợp :&gt;) để tìm ra flag 1 cách dễ dàng.</p>
<h4 id="check-function-trong-ida">Check function trong IDA</h4>
<p><img src="https://i.imgur.com/05vJL5k.png" alt=""></p>
<p>Dễ thấy trong mục function không có main nên mình cũng hơi mông lung 1 chút trong việc suy nghĩ liệu hàm main có bị ẩn đi hay không và nếu ẩn đi thì làm thế nào để mở được.</p>
<p>Quay lại đề bài 1 chút, để ý rằng đề bài có nhắc đến <code>see the number</code></p>
<p><img src="https://i.imgur.com/TnCTZ7a.png" alt=""></p>
<p>Lúc đầu mình cũng không để ý lắm tới khi sử dụng lệnh <code>strings enormous</code> và hiện ra 1 loạt các dòng số và chữ</p>
<p><img src="https://i.imgur.com/UISVpGX.png" alt=""></p>
<p>nên mình để ý tới các function ngay bên dưới có chứa các kí tự gồm số và chữ cái</p>
<p><img src="https://i.imgur.com/qr8fj8l.png" alt=""></p>
<p>Khi nhấn vào function đầu tiên thì hiện ra graph overview như sau:</p>
<p><img src="https://i.imgur.com/Jb4SH1H.png" alt=""></p>
<p>và với 1 người chơi hệ tâm linh như mình thì mình cảm nhận chữ <code>a</code> này hơi quen, hình như nó ở format của flag thì phải <code>accessdenied{}</code></p>
<p>mình tiếp tục xem các function tiếp theo lần lượt hiện c, c, e, s, s, &hellip; nên mình chắc ăn đây là flag và hoàn toàn chúng ta có thể chạy từng function một để ghép lại thành flag hoàn chỉnh</p>
<p>Sau quá trình gian nan, thì mình ghép lại được cụm flag là:</p>
<h5 id="---flag-accessdeniedus3_angr_f0rm4klng_lif3_b3tt3r_57a27836-">&ndash;&gt; **<em>flag: accessdenied{US3_AngR_F0RM4klnG_Lif3_B3Tt3R_57a27836}</em> **</h5>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
